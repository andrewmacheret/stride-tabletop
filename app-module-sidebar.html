<!DOCTYPE html>

<!-- Sample implementation of a chat:sidebar module -->

<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>App Sidebar</title>

  <!-- Import AtlasKit: https://atlaskit.atlassian.com -->
  <link rel="stylesheet" href="node_modules/@atlaskit/css-reset/dist/bundle.css"/>
  <link rel="stylesheet" href="node_modules/@atlaskit/reduced-ui-pack/dist/bundle.css"/>

  <!-- Import JQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Import the Stride Javascript API -->
  <script src='https://dev-lib.stride.com/javascript/simple-xdm.js'></script>


  <script>
    $(document).ready(function () {

      /**
       * Open a dialog from the sidebar
       */
      $("#openDialog").click(function () {
        AP.dialog.open({key: "refapp-dialog"});
      });

      /**
       * Open the app configuration from the sidebar
       */
      $("#openConfig").click(function () {
        AP.dialog.open({key: "refapp-dialog-config"});
      });

      /**
       * This is an example of how to call your app back-end from the front-end.
       * You include a JWT token generated by Stride to:
       * 1. Validate that the request is coming from your app
       * 2. Send the context of the query (cloudId, conversationId) to the app back-end
       */
      $("#pingApp").click(function () {
        AP.auth.withToken(function (err, token) {
          $.ajax(
              {
                type: 'POST',
                url: '/ui/ping',
                headers: {'Authorization': 'Bearer ' + token},
                dataType: 'json',
                success: function (data) {
                  $("#info").text('Response from the app backend: ' + data.status);
                },
                error: function (data) {
                  console.log(data);
                }
              }
          );
        });
      });
    });
  </script>
</head>
<body>
<p>This is a sidebar for your app. You can use it to show a list of cards that should be "sticky" in the conversation.</p>

<p>For example a list of high priority tasks the team has to complete, a list of decisions that were reached
recently or a list of open questions that are blocking team members.</p>

<p><button type="button" id="openDialog" class="ak-button ak-button__appearance-default">Open a dialog</button></p>
<p><button type="button" id="pingApp" class="ak-button ak-button__appearance-default">Ping the app backend</button></p>
<p><button type="button" id="openConfig" class="ak-button ak-button__appearance-default">Open the app config</button></p>
<p id="info"/>
</p>
</body>
</html>